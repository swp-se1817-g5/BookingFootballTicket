function initSearch(sellTicketURL,mapNamingURL){var convUpcomingGame=$("#convUpcomingGame").val();var resultTemplate="<p class=\"result\" data-link=\"{{eventLink}}\" data-label=\"{{label}}\">"+convUpcomingGame+": {{label}}  -  {{desc}}</p>"
$(".modal-forminput").autocomplete(searchSettings).data('ui-autocomplete')._renderMenu=function renderMenu(ul,items){ul=$("#results-container .container");if(!ul.length){$("#results-container").append($("<div class=container>"));ul=$("#results-container .container");ul.off("click").on("click",function(ev){ev.stopImmediatePropagation();window.location=$(ev.target).data("link");return false;});}
var html="";$.each(items,function(index,item){html+=parseTemplate(resultTemplate)(item);});ul.html(html).find(".result").hover(function(ev){ev.stopImmediatePropagation();$(".modal-forminput").val($(ev.target).data("label"));});};var optionsTemplate='<option value="{{id}}" >{{title}}</option>';var liTemplate='<li>';liTemplate+='<input type="checkbox" value="{{id}}" name="restrictions[{{id}}]">';liTemplate+='<label>{{title}}</label>';liTemplate+='</li>';function buildOptions(idsTitles,aTemplate,hasSelect){var retVal;var conSelect=$("#conSelect").val();if(conSelect==null){conSelect='Select';}
if(hasSelect&&typeof idsTitles=="object"&&idsTitles.unshift){idsTitles.unshift({id:"",title:"-"+conSelect+"-"});}else{retVal="<option value=''>-"+conSelect+"-</option>";}
$.each(idsTitles,function(key,type){retVal+=parseTemplate(aTemplate)(type);});return retVal;}
var $qlw=$(".quick_list_window ");$(".game_list_for").autocomplete({minLength:1,source:liveSearch,focus:function(event,ui){$(this).val(ui.item.label);$(".quick-list-tickets .ticket_id").val(ui.item.eventId);return false;},select:function(event,ui){var url=sellTicketURL+ui.item.eventId;$.get({url:url,success:function(response){$("#ticket_type").html(buildOptions(response.ticketTypes,optionsTemplate,true));$("#ticket_category").html(buildOptions(response.formOfTickets,optionsTemplate,true));if(response.event_in_guest_stadium=="1"){$("#team_side").html(buildOptions(response.teams,optionsTemplate));$("#guest_stadium").val(response.event_in_guest_stadium);$("#team_side_div").show();}else{$("#team_side_div").hide();}
$qlw.find(".booking_fees_perc").val(response.booking_fees_perc);$qlw.find(".restrictions-yes select").html(buildOptions(response.restrictions,optionsTemplate));if(response.stadium!=0){stadium_url=mapNamingURL+encodeURI((response.node_stadium!=null)?response.node_stadium:response.stadium);$qlw.find(".stadium_url").val(stadium_url);}else{$qlw.find(".stadium_url").val("");}},error:function(e){console.log("error:",e);}});return false;}}).data('ui-autocomplete')._renderItem=_renderItem;;}
function initFavourites(favURL){$('body').on('click','.favourite-toggle',function(ev){ev.stopImmediatePropagation();var $this=$(this);var $params=$this.closest(".favourite");var oData={item_id:$params.attr("uid"),item_type:$params.attr("type")};var selector=parseTemplate(".{{item_type}}_{{item_id}} .favourite-toggle")(oData);$(selector).toggleClass("active");$.post({url:favURL,dataType:'json',data:oData,success:function(returndata){if(returndata.status==true){if(returndata.message=="Saved"){$(selector).addClass('active');}else{$(selector).removeClass('active');}}else{if(returndata.message=="not loggedin"){$('.auth_window').addClass('active');$(selector).toggleClass("active");}}},error:function(e){console.log("error:",e);}});});}